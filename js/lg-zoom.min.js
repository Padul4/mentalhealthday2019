!function(o,e){"function"==typeof define&&define.amd?define(["jquery"],function(o){return e(o)}):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(0,function(o){!function(){"use strict";var e={scale:1,zoom:!0,actualSize:!0,enableZoomAfter:300,useLeftForZoom:function(){var o=!1,e=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return e&&parseInt(e[2],10)<54&&(o=!0),o}()},t=function(t){return this.core=o(t).data("lightGallery"),this.core.s=o.extend({},e,this.core.s),this.core.s.zoom&&this.core.doCss()&&(this.init(),this.zoomabletimeout=!1,this.pageX=o(window).width()/2,this.pageY=o(window).height()/2+o(window).scrollTop()),this};t.prototype.init=function(){var e=this,t='<span id="lg-zoom-in" class="lg-icon"></span><span id="lg-zoom-out" class="lg-icon"></span>';e.core.s.actualSize&&(t+='<span id="lg-actual-size" class="lg-icon"></span>'),e.core.s.useLeftForZoom?e.core.$outer.addClass("lg-use-left-for-zoom"):e.core.$outer.addClass("lg-use-transition-for-zoom"),this.core.$outer.find(".lg-toolbar").append(t),e.core.$el.on("onSlideItemLoad.lg.tm.zoom",function(t,a,r){var s=e.core.s.enableZoomAfter+r;o("body").hasClass("lg-from-hash")&&r?s=0:o("body").removeClass("lg-from-hash"),e.zoomabletimeout=setTimeout(function(){e.core.$slide.eq(a).addClass("lg-zoomable")},s+30)});var a=1,r=function(t){var a,r,s=e.core.$outer.find(".lg-current .lg-image"),i=(o(window).width()-s.prop("offsetWidth"))/2,n=(o(window).height()-s.prop("offsetHeight"))/2+o(window).scrollTop(),l=(t-1)*(a=e.pageX-i),c=(t-1)*(r=e.pageY-n);s.css("transform","scale3d("+t+", "+t+", 1)").attr("data-scale",t),e.core.s.useLeftForZoom?s.parent().css({left:-l+"px",top:-c+"px"}).attr("data-x",l).attr("data-y",c):s.parent().css("transform","translate3d(-"+l+"px, -"+c+"px, 0)").attr("data-x",l).attr("data-y",c)},s=function(){a>1?e.core.$outer.addClass("lg-zoomed"):e.resetZoom(),a<1&&(a=1),r(a)},i=function(t,r,i,n){var l,c=r.prop("offsetWidth");l=e.core.s.dynamic?e.core.s.dynamicEl[i].width||r[0].naturalWidth||c:e.core.$items.eq(i).attr("data-width")||r[0].naturalWidth||c;e.core.$outer.hasClass("lg-zoomed")?a=1:l>c&&(a=l/c||2),n?(e.pageX=o(window).width()/2,e.pageY=o(window).height()/2+o(window).scrollTop()):(e.pageX=t.pageX||t.originalEvent.targetTouches[0].pageX,e.pageY=t.pageY||t.originalEvent.targetTouches[0].pageY),s(),setTimeout(function(){e.core.$outer.removeClass("lg-grabbing").addClass("lg-grab")},10)},n=!1;e.core.$el.on("onAferAppendSlide.lg.tm.zoom",function(o,t){var a=e.core.$slide.eq(t).find(".lg-image");a.on("dblclick",function(o){i(o,a,t)}),a.on("touchstart",function(o){n?(clearTimeout(n),n=null,i(o,a,t)):n=setTimeout(function(){n=null},300),o.preventDefault()})}),o(window).on("resize.lg.zoom scroll.lg.zoom orientationchange.lg.zoom",function(){e.pageX=o(window).width()/2,e.pageY=o(window).height()/2+o(window).scrollTop(),r(a)}),o("#lg-zoom-out").on("click.lg",function(){e.core.$outer.find(".lg-current .lg-image").length&&(a-=e.core.s.scale,s())}),o("#lg-zoom-in").on("click.lg",function(){e.core.$outer.find(".lg-current .lg-image").length&&(a+=e.core.s.scale,s())}),o("#lg-actual-size").on("click.lg",function(o){i(o,e.core.$slide.eq(e.core.index).find(".lg-image"),e.core.index,!0)}),e.core.$el.on("onBeforeSlide.lg.tm",function(){a=1,e.resetZoom()}),e.zoomDrag(),e.zoomSwipe()},t.prototype.resetZoom=function(){this.core.$outer.removeClass("lg-zoomed"),this.core.$slide.find(".lg-img-wrap").removeAttr("style data-x data-y"),this.core.$slide.find(".lg-image").removeAttr("style data-scale"),this.pageX=o(window).width()/2,this.pageY=o(window).height()/2+o(window).scrollTop()},t.prototype.zoomSwipe=function(){var o=this,e={},t={},a=!1,r=!1,s=!1;o.core.$slide.on("touchstart.lg",function(t){if(o.core.$outer.hasClass("lg-zoomed")){var a=o.core.$slide.eq(o.core.index).find(".lg-object");s=a.prop("offsetHeight")*a.attr("data-scale")>o.core.$outer.find(".lg").height(),((r=a.prop("offsetWidth")*a.attr("data-scale")>o.core.$outer.find(".lg").width())||s)&&(t.preventDefault(),e={x:t.originalEvent.targetTouches[0].pageX,y:t.originalEvent.targetTouches[0].pageY})}}),o.core.$slide.on("touchmove.lg",function(i){if(o.core.$outer.hasClass("lg-zoomed")){var n,l,c=o.core.$slide.eq(o.core.index).find(".lg-img-wrap");i.preventDefault(),a=!0,t={x:i.originalEvent.targetTouches[0].pageX,y:i.originalEvent.targetTouches[0].pageY},o.core.$outer.addClass("lg-zoom-dragging"),l=s?-Math.abs(c.attr("data-y"))+(t.y-e.y):-Math.abs(c.attr("data-y")),n=r?-Math.abs(c.attr("data-x"))+(t.x-e.x):-Math.abs(c.attr("data-x")),(Math.abs(t.x-e.x)>15||Math.abs(t.y-e.y)>15)&&(o.core.s.useLeftForZoom?c.css({left:n+"px",top:l+"px"}):c.css("transform","translate3d("+n+"px, "+l+"px, 0)"))}}),o.core.$slide.on("touchend.lg",function(){o.core.$outer.hasClass("lg-zoomed")&&a&&(a=!1,o.core.$outer.removeClass("lg-zoom-dragging"),o.touchendZoom(e,t,r,s))})},t.prototype.zoomDrag=function(){var e=this,t={},a={},r=!1,s=!1,i=!1,n=!1;e.core.$slide.on("mousedown.lg.zoom",function(a){var s=e.core.$slide.eq(e.core.index).find(".lg-object");n=s.prop("offsetHeight")*s.attr("data-scale")>e.core.$outer.find(".lg").height(),i=s.prop("offsetWidth")*s.attr("data-scale")>e.core.$outer.find(".lg").width(),e.core.$outer.hasClass("lg-zoomed")&&o(a.target).hasClass("lg-object")&&(i||n)&&(a.preventDefault(),t={x:a.pageX,y:a.pageY},r=!0,e.core.$outer.scrollLeft+=1,e.core.$outer.scrollLeft-=1,e.core.$outer.removeClass("lg-grab").addClass("lg-grabbing"))}),o(window).on("mousemove.lg.zoom",function(o){if(r){var l,c,d=e.core.$slide.eq(e.core.index).find(".lg-img-wrap");s=!0,a={x:o.pageX,y:o.pageY},e.core.$outer.addClass("lg-zoom-dragging"),c=n?-Math.abs(d.attr("data-y"))+(a.y-t.y):-Math.abs(d.attr("data-y")),l=i?-Math.abs(d.attr("data-x"))+(a.x-t.x):-Math.abs(d.attr("data-x")),e.core.s.useLeftForZoom?d.css({left:l+"px",top:c+"px"}):d.css("transform","translate3d("+l+"px, "+c+"px, 0)")}}),o(window).on("mouseup.lg.zoom",function(o){r&&(r=!1,e.core.$outer.removeClass("lg-zoom-dragging"),!s||t.x===a.x&&t.y===a.y||(a={x:o.pageX,y:o.pageY},e.touchendZoom(t,a,i,n)),s=!1),e.core.$outer.removeClass("lg-grabbing").addClass("lg-grab")})},t.prototype.touchendZoom=function(o,e,t,a){var r=this.core.$slide.eq(this.core.index).find(".lg-img-wrap"),s=this.core.$slide.eq(this.core.index).find(".lg-object"),i=-Math.abs(r.attr("data-x"))+(e.x-o.x),n=-Math.abs(r.attr("data-y"))+(e.y-o.y),l=(this.core.$outer.find(".lg").height()-s.prop("offsetHeight"))/2,c=Math.abs(s.prop("offsetHeight")*Math.abs(s.attr("data-scale"))-this.core.$outer.find(".lg").height()+l),d=(this.core.$outer.find(".lg").width()-s.prop("offsetWidth"))/2,g=Math.abs(s.prop("offsetWidth")*Math.abs(s.attr("data-scale"))-this.core.$outer.find(".lg").width()+d);(Math.abs(e.x-o.x)>15||Math.abs(e.y-o.y)>15)&&(a&&(n<=-c?n=-c:n>=-l&&(n=-l)),t&&(i<=-g?i=-g:i>=-d&&(i=-d)),a?r.attr("data-y",Math.abs(n)):n=-Math.abs(r.attr("data-y")),t?r.attr("data-x",Math.abs(i)):i=-Math.abs(r.attr("data-x")),this.core.s.useLeftForZoom?r.css({left:i+"px",top:n+"px"}):r.css("transform","translate3d("+i+"px, "+n+"px, 0)"))},t.prototype.destroy=function(){this.core.$el.off(".lg.zoom"),o(window).off(".lg.zoom"),this.core.$slide.off(".lg.zoom"),this.core.$el.off(".lg.tm.zoom"),this.resetZoom(),clearTimeout(this.zoomabletimeout),this.zoomabletimeout=!1},o.fn.lightGallery.modules.zoom=t}()});